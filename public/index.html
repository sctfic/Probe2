<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script>
    // Force le rechargement des ressources (CSS/JS) pour éviter les problèmes de cache en développement.
    // Un timestamp unique est ajouté comme paramètre de version.
    (function() {
        const cacheExceptions = ['d3.min.js', 'plot.umd.js', 'monokai-sublime.css'];
        const bustCache = `?v=${new Date().getTime()}`;
        const resources = [
            { selector: 'link[rel="stylesheet"]', attribute: 'href' },
            { selector: 'script[src]', attribute: 'src' }
        ];

        const observer = new MutationObserver((mutations) => {
            mutations.forEach(mutation => {
                mutation.addedNodes.forEach(node => {
                    if (node.nodeType === 1) { // ELEMENT_NODE
                        resources.forEach(resource => {
                            const elements = node.matches(resource.selector) ? [node] : node.querySelectorAll(resource.selector);
                            elements.forEach(el => {
                                const resourceUrl = el[resource.attribute];
                                const resourceName = resourceUrl.split('/').pop();

                                // Appliquer le cache-busting sauf pour les exceptions
                                if (!cacheExceptions.includes(resourceName)) {
                                    const url = new URL(resourceUrl, window.location.origin);
                                    if (url.origin === window.location.origin && !url.search.includes('v=')) {
                                    el[resource.attribute] += bustCache;
                                    }
                                }
                            });
                        });
                    }
                });
            });
        });
        observer.observe(document.documentElement, { childList: true, subtree: true });
    })();
    /**
     * Fonction pour ajouter ou modifier une règle CSS dynamiquement.
     * @param {string} selector - Le sélecteur CSS (ex: '.access-control-icon').
     * @param {string} style - La ou les propriétés CSS (ex: 'display: inline-block;').
     */
    function overrideCssRule(selector, style) {
        // Crée un conteneur pour notre nouvelle règle.
        const styleElement = document.createElement('style');
        
        // Définit le contenu de la balise <style>.
        // L'ajout de !important est une sécurité pour garantir que cette règle l'emporte.
        styleElement.textContent = `
            ${selector} {
            ${style} !important;
            }
        `;
        
        // Ajoute la nouvelle balise <style> à la fin du <head> du document.
        document.head.appendChild(styleElement);
        
        console.log(`La règle pour '${selector}' a été surchargée.`);
    }

// Appel de la fonction pour modifier votre classe
</script>
<title>Probe Météo</title>
<!-- Observable Plot -->
<script src="js/drawing/d3.min.js"></script>
<script src="js/drawing/plot.umd.js"></script>
<script src="js/drawing/miniPlot.js"></script>
<script src="js/drawing/miniPlots.js"></script>
<script src="js/drawing/miniVectors.js"></script>
<script src="js/sensorsMap.js"></script>
<!-- External CSS and JS -->
<link rel="stylesheet" href="css/main.css">
<!-- For Textarea Editor -->
<link rel="stylesheet" href="css/monokai-sublime.css">
<link rel="stylesheet" href="css/textareaEditor.css">
</head>
<body>
<header class="navbar">
    <div class="logo">
        <img src="img/probe-logo.png" alt="Probe Logo">
    </div>
    <nav>
        <ul class="nav-menu">
            <li data-section="dashboard-section" class="active" title="Dashboard">
                <svg class="nav-icon" viewBox="0 0 512 512" fill="currentColor"><g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"><path d="M4200 4837 c-170 -58 -294 -194 -335 -369 -8 -35 -15 -78 -15 -95 l0 -33 -1795 0 -1795 0 0 -1480 0 -1480 1125 0 1125 0 0 -39 c0 -21 7 -75 15 -120 85 -446 421 -809 860 -927 136 -36 376 -45 511 -19 352 69 640 277 818 590 57 99 100 216 127 347 29 144 23 367 -15 511 -56 216 -149 378 -309 540 l-107 110 2 740 3 740 55 14 c233 58 389 252 390 484 0 223 -131 412 -338 485 -92 32 -229 33 -322 1z m276 -104 c66 -22 147 -76 184 -123 170 -215 86 -523 -170 -621 -78 -30 -222 -24 -295 11 -69 33 -152 114 -186 182 -108 215 5 482 234 553 60 19 174 18 233 -2z m-591 -550 c10 -27 32 -70 48 -97 l30 -49 -239 -233 c-188 -184 -243 -232 -259 -228 -54 14 -99 15 -141 4 l-46 -13 -81 81 -81 81 12 39 c33 108 -17 213 -120 256 -71 30 -164 10 -218 -45 -52 -54 -74 -151 -50 -214 10 -26 1 -37 -182 -226 -141 -147 -196 -198 -207 -193 -39 17 -138 16 -172 -1 -82 -42 -122 -103 -122 -186 0 -186 224 -273 350 -136 54 58 70 122 49 192 l-16 50 193 193 c155 155 196 192 212 187 43 -14 125 -17 157 -6 32 11 33 11 117 -73 81 -81 84 -86 73 -111 -20 -43 -15 -117 11 -166 62 -117 214 -144 314 -56 65 57 86 135 61 219 l-12 39 165 165 c90 91 198 196 239 234 l76 68 54 -34 c31 -19 88 -42 128 -52 l72 -17 0 -706 0 -706 -75 39 c-216 113 -475 159 -699 123 -266 -41 -472 -144 -663 -329 l-93 -89 0 151 c0 83 -4 162 -10 176 l-10 26 -189 0 c-178 0 -191 -1 -201 -19 -6 -13 -10 -159 -10 -408 0 -462 -7 -433 105 -433 l75 0 -6 -27 c-3 -16 -8 -57 -12 -93 l-7 -65 -1067 -3 -1068 -2 0 1370 0 1370 1749 0 1748 0 18 -47z m-888 -286 c12 -12 25 -37 29 -54 6 -28 2 -37 -29 -68 -37 -37 -60 -42 -102 -23 -27 12 -55 54 -55 82 0 31 26 69 55 82 37 17 73 10 102 -19z m450 -450 c12 -12 25 -37 29 -54 6 -28 2 -37 -29 -68 -37 -37 -60 -42 -102 -23 -27 12 -55 54 -55 82 0 31 26 69 55 82 37 17 73 10 102 -19z m-1122 -222 c19 -18 25 -35 25 -65 0 -55 -34 -90 -88 -90 -53 0 -92 38 -92 90 0 80 99 122 155 65z m1303 -891 l-3 -167 -88 -18 c-366 -74 -623 -426 -577 -792 6 -47 22 -121 36 -164 15 -42 23 -79 18 -80 -5 -2 -70 -39 -144 -82 l-135 -79 -14 27 c-61 114 -101 294 -102 465 -1 333 147 630 419 839 152 117 397 212 560 216 l32 1 -2 -166z m334 130 c304 -81 577 -317 699 -605 62 -146 82 -247 83 -424 1 -145 -2 -169 -26 -255 -31 -111 -72 -213 -86 -218 -6 -2 -73 34 -151 78 -117 68 -139 85 -132 98 58 109 78 330 43 470 -26 101 -78 207 -142 288 -102 128 -279 232 -437 257 l-73 12 0 168 0 169 65 -7 c36 -4 107 -18 157 -31z m-1312 -248 l0 -214 -29 -58 c-15 -33 -36 -80 -46 -106 -17 -47 -18 -48 -61 -48 l-44 0 0 320 0 320 90 0 90 0 0 -214z m1237 -196 c256 -90 427 -349 410 -619 -14 -227 -141 -420 -340 -515 -51 -24 -116 -49 -145 -55 -82 -17 -200 -13 -287 9 -211 54 -386 231 -440 445 -19 75 -19 233 0 305 55 206 225 381 430 442 86 26 285 19 372 -12z m-760 -1054 c80 -102 237 -200 381 -237 93 -24 243 -25 339 -4 37 9 111 37 163 62 80 40 109 61 188 140 l93 93 142 -82 c78 -44 143 -82 145 -83 2 -1 -24 -36 -56 -76 -220 -277 -536 -421 -887 -406 -206 9 -392 72 -560 188 -77 53 -236 212 -267 266 l-17 29 142 82 c78 45 144 82 147 82 3 0 24 -24 47 -54z"></path><path d="M576 4024 c-19 -18 -21 -65 -4 -82 18 -18 63 -14 81 6 22 25 21 48 -3 72 -24 24 -53 26 -74 4z"></path><path d="M876 4024 c-19 -18 -21 -65 -4 -82 9 -9 131 -12 489 -12 l478 0 15 22 c21 30 20 44 -4 68 -19 19 -33 20 -489 20 -414 0 -471 -2 -485 -16z"></path><path d="M576 3724 c-23 -22 -20 -71 3 -84 31 -16 59 -12 75 12 21 30 20 44 -4 68 -24 24 -53 26 -74 4z"></path><path d="M876 3724 c-19 -18 -21 -65 -4 -82 9 -9 131 -12 489 -12 l478 0 15 22 c21 30 20 44 -4 68 -19 19 -33 20 -489 20 -414 0 -471 -2 -485 -16z"></path><path d="M576 3424 c-23 -22 -20 -71 3 -84 31 -16 59 -12 75 12 21 30 20 44 -4 68 -24 24 -53 26 -74 4z"></path><path d="M876 3424 c-19 -18 -21 -65 -4 -82 9 -9 131 -12 489 -12 l478 0 15 22 c21 30 20 44 -4 68 -19 19 -33 20 -489 20 -414 0 -471 -2 -485 -16z"></path><path d="M576 3124 c-23 -22 -20 -71 3 -84 31 -16 59 -12 75 12 21 30 20 44 -4 68 -24 24 -53 26 -74 4z"></path><path d="M876 3124 c-19 -18 -21 -65 -4 -82 9 -9 131 -12 489 -12 l478 0 15 22 c21 30 20 44 -4 68 -19 19 -33 20 -489 20 -414 0 -471 -2 -485 -16z"></path><path d="M1766 2818 c-14 -20 -16 -89 -16 -558 0 -469 2 -538 16 -558 15 -21 21 -22 193 -22 160 0 180 2 194 18 15 17 17 70 17 558 0 472 -2 542 -16 562 -15 21 -21 22 -194 22 -173 0 -179 -1 -194 -22z m284 -558 l0 -470 -90 0 -90 0 0 470 0 470 90 0 90 0 0 -470z"></path><path d="M572 2378 c-17 -17 -17 -669 0 -686 8 -8 65 -12 188 -12 159 0 179 2 193 18 15 16 17 55 17 336 0 200 -4 324 -10 337 -10 18 -23 19 -193 19 -129 0 -187 -4 -195 -12z m286 -340 l-3 -243 -92 -3 -93 -3 0 246 0 245 95 0 95 0 -2 -242z"></path><path d="M1170 2230 c-21 -13 -28 -481 -7 -520 l13 -25 178 -3 c156 -2 181 0 197 14 18 16 19 36 19 261 0 149 -4 252 -10 264 -10 18 -23 19 -193 19 -100 0 -189 -5 -197 -10z m280 -270 l0 -170 -90 0 -90 0 0 170 0 170 90 0 90 0 0 -170z"></path><path d="M3588 1854 c-172 -41 -297 -173 -329 -347 -32 -171 58 -358 215 -447 212 -122 483 -36 593 188 34 67 38 86 41 163 6 145 -35 246 -139 344 -54 51 -125 86 -207 104 -66 14 -102 13 -174 -5z m233 -132 c59 -29 114 -84 147 -147 23 -43 27 -62 27 -140 0 -78 -4 -97 -27 -140 -78 -147 -247 -213 -401 -155 -63 24 -136 90 -168 152 -31 59 -38 190 -15 252 35 91 103 159 193 192 58 22 187 14 244 -14z"></path></g></svg>
            </li>
            <li data-section="stations-section" title="Stations">
                <svg class="nav-icon" viewBox="0 0 512 512" fill="currentColor"><g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"><path d="M395 4964 c-203 -72 -225 -355 -35 -458 70 -38 132 -43 200 -16 68 27 122 78 150 141 l21 49 220 0 220 0 -3 -62 -3 -63 -67 -5 c-57 -4 -72 -9 -95 -33 -27 -26 -28 -33 -33 -145 -5 -102 -9 -123 -31 -162 -35 -60 -219 -408 -219 -414 0 -2 56 -110 125 -239 l125 -236 0 -98 c0 -147 29 -183 146 -183 l54 0 0 -70 0 -70 -444 0 c-433 0 -444 0 -470 -21 l-26 -20 0 -234 c0 -128 3 -241 6 -250 17 -45 141 -60 244 -29 49 14 74 36 291 245 l238 230 78 -3 78 -3 5 -74 c4 -56 9 -77 23 -85 34 -22 52 4 57 85 l5 74 334 5 c304 5 335 7 345 23 8 12 8 22 0 35 -10 15 -41 17 -345 22 l-334 5 0 65 0 65 67 6 c107 9 128 40 128 184 0 93 1 99 39 168 21 40 69 131 106 202 37 72 72 136 78 143 7 9 92 12 386 10 l376 -3 0 -655 0 -655 -390 -5 c-424 -5 -420 -5 -455 -63 -19 -31 -20 -55 -20 -562 0 -507 1 -531 20 -562 35 -58 31 -58 455 -63 l390 -5 0 -305 0 -305 -360 -5 c-391 -5 -390 -5 -425 -63 -17 -28 -20 -51 -20 -182 0 -104 4 -155 12 -163 9 -9 269 -12 1109 -12 l1098 0 15 22 c12 17 16 49 16 136 0 137 -12 191 -52 229 l-29 28 -365 3 -364 3 0 309 0 310 383 0 c361 0 384 1 414 20 71 43 68 15 68 605 0 590 3 562 -68 605 -30 19 -53 20 -414 20 l-383 0 0 660 0 660 389 0 389 0 4 -137 c4 -158 14 -185 87 -218 l41 -18 0 -352 c0 -260 3 -354 12 -363 9 -9 111 -12 400 -12 373 0 388 1 398 19 6 13 10 146 10 365 l0 346 34 14 c18 8 45 29 59 48 l27 34 0 494 1 493 -29 36 c-49 61 -59 62 -522 59 -455 -3 -454 -3 -496 -65 -17 -26 -19 -53 -22 -340 l-3 -313 -390 0 c-214 0 -392 -1 -396 -2 -5 -2 -55 92 -113 209 -58 117 -116 224 -129 238 -29 30 -93 34 -129 9 -13 -9 -70 -109 -132 -235 l-110 -219 -384 0 -385 0 -39 73 c-22 39 -73 133 -113 207 l-72 135 -6 110 c-9 154 -25 177 -130 185 l-66 5 -3 63 -3 62 199 0 199 0 17 -43 c31 -83 123 -153 214 -164 104 -11 235 79 263 180 33 124 -26 247 -146 303 -70 33 -127 31 -202 -6 -65 -33 -102 -72 -132 -142 l-18 -43 -196 3 -196 3 -3 76 c-2 59 -7 78 -20 87 -13 8 -23 8 -35 0 -14 -9 -19 -28 -21 -88 l-3 -76 -222 2 -221 3 -10 33 c-14 51 -83 122 -143 149 -60 26 -118 28 -178 7z m177 -98 c44 -29 68 -80 68 -145 0 -51 -4 -62 -35 -98 -43 -51 -81 -67 -146 -61 -62 6 -97 31 -127 89 -65 125 38 264 178 239 19 -4 47 -14 62 -24z m1421 -3 c75 -48 97 -153 47 -226 -39 -57 -68 -72 -140 -72 -79 0 -122 26 -151 89 -25 54 -24 103 4 150 53 93 151 117 240 59z m-633 -473 l0 -80 -150 0 -150 0 0 73 c0 41 3 77 7 80 3 4 71 7 150 7 l143 0 0 -80z m3464 64 c11 -11 16 -35 16 -80 l0 -64 -450 0 -450 0 0 68 c0 40 5 73 12 80 9 9 119 12 434 12 371 0 424 -2 438 -16z m-1952 -439 l107 -210 1 -688 0 -687 -227 2 -228 3 -3 676 -2 676 105 214 c57 118 107 218 111 222 4 4 13 6 18 4 6 -1 59 -97 118 -212z m-1447 127 c22 -42 65 -125 97 -184 32 -58 58 -109 58 -112 0 -3 -103 -6 -229 -6 -195 0 -232 -2 -245 -16 -22 -21 -20 -40 6 -58 19 -13 60 -16 245 -16 123 0 223 -2 223 -4 0 -5 -57 -113 -143 -271 l-55 -100 -173 0 -173 0 -94 175 c-51 96 -96 181 -99 188 -4 8 8 12 42 12 62 0 85 14 85 49 0 34 -14 41 -81 41 -27 0 -49 3 -49 6 0 7 162 312 187 352 13 21 18 22 186 22 l172 0 40 -78z m3415 -279 c0 -318 -2 -358 -17 -375 -15 -17 -42 -18 -438 -18 -314 0 -424 3 -433 12 -9 9 -12 106 -12 375 l0 363 450 0 450 0 0 -357z m-130 -563 l0 -80 -322 2 -323 3 -3 64 c-2 35 -1 70 2 77 4 11 65 14 326 14 l320 0 0 -80z m-3355 -95 l0 -80 -145 0 -145 0 -3 83 -3 83 148 -3 148 -3 0 -80z m3355 -145 l0 -80 -325 0 -325 0 0 73 c0 41 3 77 7 80 3 4 150 7 325 7 l318 0 0 -80z m0 -250 l0 -80 -322 2 -323 3 -3 64 c-2 35 -1 70 2 77 4 11 65 14 326 14 l320 0 0 -80z m-3840 1 c0 -15 -377 -370 -404 -381 -15 -5 -56 -10 -92 -10 l-64 0 0 193 c0 107 3 197 7 200 10 10 553 8 553 -2z m2962 -478 c17 -15 18 -45 18 -529 l0 -513 -22 -15 c-20 -14 -139 -16 -1080 -16 -1045 0 -1058 0 -1078 20 -19 19 -20 33 -20 527 0 457 2 508 17 525 15 17 62 18 1081 18 977 0 1067 -1 1084 -17z m-854 -1460 l-3 -308 -225 0 -225 0 -3 295 c-1 162 0 300 3 307 3 10 58 13 230 13 l225 0 -2 -307z m791 -410 c20 -17 22 -26 19 -128 l-3 -110 -1035 0 -1035 0 -3 107 c-2 97 -1 109 18 128 20 20 28 20 1019 20 936 0 1000 -1 1020 -17z"></path><path d="M2132 2228 c-8 -8 -12 -66 -12 -195 l0 -183 -164 0 c-136 0 -167 -3 -180 -16 -22 -21 -20 -40 6 -58 18 -13 54 -16 180 -16 l158 0 0 -179 c0 -150 3 -182 16 -195 8 -9 21 -16 28 -16 32 0 36 24 36 207 l0 183 255 0 255 0 0 -179 c0 -150 3 -182 16 -195 8 -9 21 -16 28 -16 32 0 36 24 36 207 l0 183 255 0 255 0 2 -186 c3 -165 5 -188 21 -198 12 -8 22 -8 35 0 15 10 17 33 20 198 l2 186 158 0 c168 0 202 8 202 50 0 33 -33 40 -199 40 l-161 0 -2 186 c-3 165 -5 188 -20 198 -13 8 -23 8 -35 0 -16 -10 -18 -33 -21 -198 l-2 -186 -255 0 -255 0 -2 186 c-3 165 -5 188 -20 198 -13 8 -23 8 -35 0 -16 -10 -18 -33 -21 -198 l-2 -186 -253 2 -252 3 -3 185 c-2 132 -6 186 -15 192 -18 11 -41 10 -55 -4z"></path></g></svg>
            </li>
            <li data-section="compositeProbes-section" title="Sondes Composites">
                <svg class="nav-icon" viewBox="0 0 512 512" fill="currentColor"><g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"><path d="M2508 4855 c-88 -22 -141 -78 -160 -168 -10 -48 -9 -64 5 -111 19 -59 75 -120 122 -132 l25 -6 0 -233 c0 -177 -3 -234 -12 -238 -7 -3 -57 -23 -110 -46 l-98 -40 0 119 c0 114 -1 120 -27 152 -51 62 -266 303 -295 331 l-28 27 -160 0 c-134 0 -160 2 -160 15 0 28 -73 92 -119 105 -143 38 -274 -92 -232 -231 42 -139 214 -182 314 -78 20 22 37 46 37 54 0 12 24 15 138 15 l139 0 137 -155 137 -155 -3 -126 -3 -127 -174 -74 c-96 -40 -180 -78 -187 -84 -10 -8 -14 -50 -16 -149 l-3 -139 -158 66 -157 66 -138 -57 c-75 -31 -140 -56 -144 -56 -5 0 -8 89 -8 198 l1 197 43 26 c77 47 107 149 67 234 -33 72 -86 105 -167 105 -59 0 -103 -19 -141 -63 -76 -87 -48 -236 53 -285 l34 -16 -2 -225 -3 -226 -175 -72 c-97 -40 -183 -82 -192 -94 -17 -19 -18 -56 -18 -449 0 -393 1 -429 18 -449 9 -11 80 -47 158 -78 78 -32 141 -62 141 -68 -1 -5 -66 -37 -146 -71 -110 -45 -149 -66 -159 -85 -9 -18 -11 -125 -10 -451 3 -375 5 -429 19 -443 16 -16 744 -325 765 -325 6 0 80 29 165 64 l154 65 3 -148 c2 -126 5 -151 20 -164 24 -21 734 -317 762 -317 29 0 761 306 772 323 4 6 8 72 8 145 0 72 4 132 8 132 5 0 74 -27 153 -60 79 -33 152 -60 162 -60 21 0 755 304 771 320 8 8 11 139 11 456 0 417 -1 446 -18 459 -10 7 -83 39 -162 71 -80 33 -145 61 -145 64 0 3 66 32 146 65 80 33 153 68 162 78 15 17 17 60 20 441 1 233 -1 433 -6 447 -7 19 -43 39 -183 99 l-174 75 -2 240 -3 240 45 27 c118 71 113 250 -10 320 -94 53 -226 6 -264 -95 -31 -80 4 -183 75 -226 l43 -26 1 -212 c0 -164 -3 -213 -12 -213 -7 0 -76 27 -152 59 -160 68 -125 70 -331 -18 -65 -28 -123 -51 -127 -51 -4 0 -8 67 -8 149 0 141 -1 151 -21 165 -12 8 -100 47 -195 87 l-174 72 0 122 0 122 138 156 137 156 110 1 110 0 19 -35 c26 -47 81 -83 141 -90 43 -5 58 -2 105 22 68 35 100 84 100 158 0 79 -33 134 -100 168 -47 24 -62 27 -105 22 -60 -7 -115 -43 -141 -90 l-19 -35 -125 -1 c-69 0 -132 -3 -141 -7 -9 -4 -54 -50 -101 -102 -46 -52 -118 -134 -161 -182 l-77 -88 0 -126 c0 -97 -3 -125 -12 -121 -7 3 -57 24 -110 47 l-98 42 0 234 c0 190 3 234 13 234 27 0 97 60 119 102 53 102 12 244 -85 294 -46 24 -110 32 -159 19z m125 -145 c37 -41 37 -89 -2 -132 -24 -27 -36 -33 -71 -33 -82 0 -129 96 -79 159 43 54 105 57 152 6z m-1148 -215 c30 -30 31 -54 4 -89 -40 -50 -119 -21 -119 44 0 64 70 91 115 45z m2190 0 c30 -30 31 -54 4 -89 -40 -50 -119 -24 -119 40 0 68 68 97 115 49z m-2515 -465 c45 -45 18 -120 -44 -120 -37 0 -49 7 -65 37 -17 33 -14 51 14 78 29 30 68 32 95 5z m2908 3 c32 -27 37 -64 12 -96 -53 -66 -154 -2 -115 73 22 43 67 53 103 23z m-1225 -283 c152 -63 277 -117 277 -120 0 -3 -126 -58 -280 -123 l-280 -117 -280 117 c-154 65 -280 120 -280 123 0 6 552 238 561 236 3 0 130 -53 282 -116z m-731 -299 c117 -49 252 -106 301 -127 l87 -37 0 -152 0 -153 -121 -51 c-67 -28 -125 -51 -130 -51 -5 0 -9 64 -9 143 0 163 -2 167 -90 201 -25 10 -93 38 -152 63 l-108 45 0 104 c0 57 2 104 5 104 3 0 100 -40 217 -89z m1116 -28 l-3 -117 -159 -67 c-88 -36 -165 -75 -173 -85 -9 -13 -13 -55 -13 -146 0 -70 -4 -128 -9 -128 -5 0 -63 23 -130 51 l-121 51 2 156 3 155 295 123 c162 68 299 123 303 123 4 1 6 -52 5 -116z m-1468 -163 c135 -56 248 -105 253 -109 4 -4 -120 -60 -275 -124 l-282 -117 -282 117 c-156 65 -281 120 -278 123 3 2 130 57 282 121 259 109 279 116 307 104 17 -6 140 -58 275 -115z m2198 -21 c149 -63 268 -116 264 -120 -12 -10 -546 -229 -559 -229 -14 0 -545 219 -556 229 -9 9 543 242 564 237 9 -2 138 -55 287 -117z m-2858 -309 c135 -56 257 -109 273 -116 l27 -15 0 -350 c0 -277 -3 -350 -12 -346 -7 3 -145 60 -305 127 l-293 123 0 353 0 354 33 -14 c17 -7 142 -59 277 -116z m1020 12 l0 -118 -152 -64 c-84 -34 -161 -70 -170 -78 -16 -13 -18 -41 -20 -235 l-3 -220 -125 -58 c-69 -32 -127 -58 -130 -59 -3 0 -3 158 0 351 l5 350 295 124 c162 68 296 124 298 124 1 1 2 -52 2 -117z m1197 -40 l283 -117 0 -352 c0 -194 -3 -353 -7 -352 -5 0 -62 24 -128 52 l-120 52 -3 241 c-2 214 -4 243 -20 256 -9 8 -86 44 -169 78 l-153 64 0 104 c0 95 2 104 18 98 9 -4 144 -60 299 -124z m1011 -223 l-3 -351 -295 -124 c-162 -68 -298 -124 -303 -124 -4 0 -6 158 -5 352 l3 352 290 122 c160 67 296 122 303 123 10 1 12 -72 10 -350z m-1475 79 c148 -61 265 -114 260 -119 -13 -13 -537 -232 -553 -231 -18 1 -541 219 -553 231 -4 4 48 31 115 59 368 155 434 181 448 176 8 -3 136 -55 283 -116z m-643 -336 l285 -119 3 -351 c1 -194 -1 -352 -6 -352 -5 0 -141 56 -303 124 l-294 123 -3 352 c-2 333 -1 352 15 347 10 -3 146 -59 303 -124z m1018 -224 l-3 -351 -285 -119 c-157 -65 -293 -121 -303 -124 -16 -5 -17 14 -15 347 l3 352 290 123 c160 67 296 123 303 123 10 1 12 -72 10 -351z m-1450 -229 l-3 -121 -160 -65 -160 -65 -280 116 c-153 64 -281 118 -282 120 -2 1 58 29 132 61 l136 57 134 -56 c74 -31 145 -56 158 -56 13 0 86 29 163 64 76 36 145 65 152 65 10 1 12 -27 10 -120z m1726 21 c80 -33 152 -60 161 -60 9 0 78 27 155 59 l139 59 135 -56 c75 -31 132 -59 128 -63 -4 -3 -86 -39 -182 -79 -96 -40 -220 -92 -276 -115 l-100 -43 -160 68 -159 67 -3 111 c-2 72 1 112 8 112 5 0 75 -27 154 -60z m-2302 -293 l198 -82 0 -352 c0 -194 -2 -353 -4 -353 -2 0 -138 56 -302 124 l-299 125 -3 355 -2 355 107 -45 c60 -25 197 -82 305 -127z m3128 -209 l0 -353 -286 -119 c-157 -65 -294 -120 -305 -123 -19 -5 -19 1 -17 346 l3 352 295 124 c162 68 298 124 303 124 4 1 7 -158 7 -351z m-2257 160 c15 -5 27 -13 27 -17 0 -4 -67 -36 -150 -71 -82 -34 -154 -68 -160 -74 -5 -8 -11 -107 -12 -241 l-3 -228 -110 -47 c-60 -25 -118 -49 -127 -53 -17 -6 -18 15 -18 347 l0 353 156 66 157 65 106 -45 c58 -25 118 -50 134 -55z m1380 6 l157 -66 0 -349 c0 -243 -3 -349 -11 -349 -6 0 -66 23 -135 52 l-124 52 0 242 c0 226 -1 244 -19 256 -10 7 -84 40 -164 73 -80 33 -144 62 -141 64 2 2 54 26 116 53 70 29 123 46 138 44 14 -3 96 -35 183 -72z m-1043 -149 c73 -30 140 -55 150 -55 10 0 77 25 150 55 73 30 138 55 144 55 16 0 266 -103 266 -110 0 -3 -126 -58 -280 -123 l-280 -117 -280 117 c-154 65 -280 120 -280 123 0 8 241 108 261 109 9 1 76 -24 149 -54z m-201 -274 c156 -66 285 -122 287 -124 3 -2 3 -162 2 -354 l-3 -350 -300 126 -300 126 -3 353 c-2 334 -1 353 15 348 10 -3 146 -60 302 -125z m1019 -223 l-3 -353 -290 -122 c-159 -67 -296 -122 -303 -122 -10 -1 -12 72 -10 351 l3 351 295 123 c162 68 298 123 303 123 4 1 6 -158 5 -351z"></path></g></svg>
            </li>
            <li data-section="settings-section" title="Settings">
                <svg class="nav-icon" viewBox="0 0 512 512" fill="currentColor"><g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"><path d="M3234 4599 c-47 -13 -72 -49 -102 -140 -26 -81 -28 -84 -64 -92 -34 -8 -41 -5 -104 42 -76 58 -115 69 -167 47 -54 -22 -235 -163 -258 -199 -25 -42 -24 -72 7 -158 26 -72 26 -74 9 -106 l-18 -33 -90 0 c-97 0 -142 -14 -166 -52 -20 -32 -101 -278 -101 -305 0 -53 28 -91 99 -139 69 -46 71 -48 71 -90 0 -41 -2 -43 -65 -84 -70 -44 -105 -88 -105 -133 0 -16 20 -91 45 -167 61 -187 91 -211 239 -196 60 6 63 5 84 -24 27 -37 27 -38 -3 -122 -29 -80 -31 -108 -10 -149 19 -36 247 -209 278 -210 67 -3 85 4 167 66 51 39 57 41 87 31 43 -15 47 -21 68 -95 36 -134 58 -146 260 -146 204 0 220 9 260 150 20 70 25 76 68 91 30 11 35 8 95 -39 68 -53 116 -69 167 -55 17 5 82 48 145 96 99 75 117 93 130 130 14 42 14 47 -16 130 l-31 87 24 32 c24 31 24 31 101 26 93 -7 142 10 172 59 21 35 100 274 100 303 0 42 -35 88 -102 132 -67 45 -68 47 -68 89 0 43 2 45 64 86 65 43 106 96 106 136 0 11 -20 83 -45 159 -60 188 -69 197 -208 201 -101 4 -103 4 -124 34 l-21 30 25 61 c31 76 35 143 10 180 -25 39 -224 184 -269 197 -52 15 -80 5 -155 -52 -57 -44 -69 -49 -98 -44 -42 8 -48 17 -70 100 -22 81 -53 122 -103 136 -45 12 -275 12 -318 -1z m280 -241 c12 -43 29 -86 38 -97 16 -19 190 -81 227 -81 10 0 51 25 89 55 39 30 74 55 77 55 6 0 72 -46 152 -105 2 -1 -11 -36 -27 -79 -17 -42 -30 -88 -30 -100 0 -27 114 -192 144 -208 12 -7 53 -9 107 -5 l88 6 30 -92 c17 -50 27 -93 22 -96 -4 -4 -37 -25 -73 -49 -36 -23 -70 -54 -76 -68 -7 -14 -12 -69 -12 -123 0 -116 5 -126 105 -191 53 -34 64 -46 59 -62 -3 -11 -16 -50 -28 -86 l-23 -67 -99 -5 c-54 -3 -104 -9 -111 -13 -26 -17 -133 -177 -133 -199 0 -13 13 -57 29 -98 l30 -75 -27 -23 c-15 -12 -50 -39 -79 -58 l-51 -36 -64 51 c-35 28 -74 54 -87 58 -36 9 -228 -55 -245 -82 -8 -12 -19 -42 -26 -66 -6 -24 -16 -59 -21 -76 l-11 -33 -94 0 c-67 0 -96 4 -99 12 -2 7 -13 45 -25 85 -11 40 -27 79 -35 87 -18 18 -191 76 -225 76 -15 0 -52 -22 -94 -55 -38 -30 -71 -55 -73 -55 -2 0 -38 25 -79 56 -58 42 -74 59 -69 72 33 81 55 146 55 161 0 20 -99 165 -132 194 -16 14 -39 17 -117 17 l-97 0 -25 83 c-13 45 -24 85 -24 89 0 4 31 29 70 55 38 26 75 59 82 73 17 33 17 197 0 230 -11 21 -43 47 -136 111 l-21 14 28 90 28 90 82 -4 c48 -2 94 2 110 8 31 13 152 174 152 202 0 10 -14 55 -30 101 -17 45 -27 85 -23 88 22 19 141 100 147 100 4 0 35 -23 69 -50 34 -28 72 -53 83 -56 12 -3 67 9 123 27 115 36 132 51 151 132 25 104 17 98 126 95 l97 -3 21 -77z"></path><path d="M3256 3905 c-188 -52 -343 -207 -390 -391 -81 -315 139 -636 463 -676 254 -32 498 123 583 370 30 88 32 240 4 322 -82 243 -282 392 -524 389 -48 0 -109 -7 -136 -14z m280 -176 c71 -27 157 -106 194 -180 98 -193 18 -425 -178 -517 -50 -24 -69 -27 -162 -27 -97 0 -109 2 -164 30 -76 39 -157 127 -187 202 -17 43 -23 80 -23 143 -1 75 3 93 30 150 89 189 294 272 490 199z"></path><path d="M1399 3882 c-40 -20 -278 -191 -323 -231 -33 -30 -56 -78 -56 -120 0 -16 20 -82 44 -146 l45 -117 -47 -64 -46 -65 -135 1 c-75 1 -145 -2 -156 -6 -11 -4 -35 -21 -53 -38 -28 -26 -42 -60 -97 -228 -36 -109 -65 -208 -65 -221 0 -12 9 -41 19 -64 16 -35 38 -54 130 -115 l111 -73 0 -82 0 -82 -106 -72 c-176 -120 -179 -130 -90 -403 59 -183 70 -207 101 -235 47 -41 66 -44 212 -39 l125 5 47 -65 c25 -35 45 -70 43 -78 -1 -7 -21 -62 -43 -121 -44 -117 -48 -168 -15 -218 20 -30 293 -236 354 -266 71 -35 113 -23 234 72 56 43 107 79 113 79 6 0 42 -11 81 -23 l69 -24 33 -118 c37 -133 57 -167 112 -195 35 -18 59 -20 242 -20 290 1 302 8 360 215 l33 118 70 24 c38 12 74 23 80 23 6 0 57 -36 113 -79 121 -95 163 -107 234 -72 61 31 334 235 354 266 33 50 29 101 -15 218 -22 59 -42 114 -43 121 -2 8 18 43 43 78 l47 65 125 -5 c146 -5 165 -2 212 39 31 27 42 53 101 233 72 218 74 238 34 304 -25 41 -163 132 -200 132 -42 0 -80 -35 -80 -74 0 -43 19 -67 84 -107 31 -18 56 -38 56 -43 0 -6 -24 -82 -52 -169 l-53 -158 -131 7 c-72 4 -144 4 -158 0 -36 -9 -206 -237 -206 -275 0 -14 20 -79 45 -144 25 -66 45 -124 45 -130 0 -11 -261 -207 -275 -207 -3 0 -54 38 -113 85 -59 47 -117 88 -129 91 -28 8 -295 -81 -315 -104 -8 -9 -27 -62 -42 -117 -15 -55 -32 -115 -37 -132 l-11 -33 -173 0 -174 0 -17 57 c-46 166 -57 200 -69 220 -17 26 -284 118 -318 109 -12 -3 -70 -44 -129 -91 -59 -47 -110 -85 -114 -85 -14 0 -274 196 -274 206 0 7 20 65 45 131 25 65 45 130 45 144 0 38 -170 266 -206 275 -14 4 -86 4 -158 0 l-131 -7 -55 165 c-30 91 -52 167 -50 169 3 2 55 37 115 77 61 40 116 79 123 88 15 19 17 314 2 341 -5 10 -60 51 -122 91 -62 40 -115 75 -118 77 -2 2 20 78 50 169 l55 166 136 -7 c75 -4 147 -4 159 0 31 10 200 241 200 274 0 14 -20 79 -45 144 -25 66 -45 124 -45 131 0 10 260 206 274 206 4 0 55 -38 114 -85 59 -47 117 -88 129 -91 33 -9 299 82 318 109 24 35 19 82 -11 106 -36 28 -64 26 -169 -9 -49 -16 -94 -30 -101 -30 -6 0 -51 32 -100 71 -128 103 -173 118 -245 81z"></path><path d="M1924 2994 c-146 -78 -275 -216 -344 -368 -49 -108 -64 -179 -64 -316 -1 -101 4 -140 22 -205 70 -246 269 -455 507 -531 98 -32 288 -44 387 -25 128 25 272 97 368 184 98 89 210 260 210 321 0 38 -41 76 -83 76 -41 0 -64 -24 -103 -105 -43 -89 -167 -210 -264 -257 -199 -96 -411 -88 -596 23 -65 39 -167 144 -206 210 -102 174 -108 399 -15 588 42 86 157 207 237 250 68 37 90 62 90 107 0 23 -8 39 -26 53 -35 28 -61 26 -120 -5z"></path></g></svg>
            </li>
        </ul>
        <div id="login-btn" title="Connexion">
            <svg class="nav-icon" viewBox="0 0 512 512" fill="currentColor"><g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"><path d="M2840 4469 c-350 -40 -676 -167 -947 -367 -108 -80 -318 -289 -397 -395 -51 -68 -159 -242 -168 -269 -2 -6 -21 1 -42 16 -57 38 -106 35 -154 -8 l-37 -34 -3 -161 -3 -161 -394 0 c-408 0 -429 -2 -473 -43 -57 -52 -57 -54 -60 -432 -2 -192 -1 -378 3 -412 8 -74 34 -119 90 -150 40 -22 44 -23 438 -23 l397 0 0 -140 c0 -161 10 -198 62 -230 44 -27 88 -25 133 5 20 15 38 25 40 23 1 -2 27 -47 58 -100 505 -865 1606 -1193 2502 -746 569 284 954 813 1050 1444 20 129 20 378 0 526 -117 881 -817 1560 -1707 1657 -111 13 -279 12 -388 0z m426 -139 c733 -92 1345 -652 1508 -1381 122 -546 -18 -1114 -380 -1541 -53 -63 -74 -75 -74 -43 0 7 -14 55 -30 105 -146 446 -453 733 -915 857 -94 25 -114 26 -325 27 -242 1 -313 -8 -469 -60 -399 -133 -696 -453 -814 -873 -12 -45 -25 -81 -29 -81 -11 0 -113 125 -167 205 -64 93 -141 229 -141 246 0 8 144 158 321 334 176 176 329 337 340 357 23 45 25 108 3 151 -9 18 -164 181 -345 362 l-329 330 53 93 c89 158 176 272 307 402 146 146 266 234 440 324 205 105 360 153 620 190 57 8 351 5 426 -4z m-1286 -1770 c0 -8 -169 -183 -375 -390 l-375 -375 0 152 c0 158 -6 194 -37 209 -10 5 -214 11 -453 14 l-435 5 0 385 0 385 440 5 c242 3 441 7 442 8 44 44 43 39 43 206 l0 161 375 -375 c206 -207 375 -382 375 -390z m1315 -355 c467 -98 794 -427 899 -908 16 -69 16 -80 3 -90 -274 -217 -495 -325 -799 -394 -115 -25 -138 -27 -353 -27 -234 0 -261 3 -460 49 -93 22 -239 77 -350 132 -91 45 -281 168 -344 223 l-34 29 23 97 c95 413 361 717 741 847 142 49 267 67 439 63 92 -2 188 -11 235 -21z"></path><path d="M2902 3819 c-123 -21 -278 -112 -371 -216 -57 -64 -132 -208 -152 -293 -17 -70 -17 -228 0 -300 7 -30 34 -98 59 -150 76 -157 211 -276 384 -338 66 -23 87 -26 213 -26 126 0 147 3 213 26 107 39 177 83 262 168 130 129 193 281 194 465 0 126 -14 186 -72 305 -77 157 -221 282 -392 341 -74 25 -247 35 -338 18z m241 -134 c249 -53 427 -273 427 -528 -1 -206 -118 -391 -305 -481 -305 -145 -668 27 -749 355 -94 383 243 736 627 654z"></path></g></svg>
        </div>
        <div id="change-password-btn" title="Changer le mot de passe">
            <svg class="nav-icon" viewBox="0 0 512 512" fill="currentColor"><g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"><path d="M3620 4141 c-280 -62 -489 -190 -681 -421 l-46 -55 -120 -5 c-112 -5 -122 -7 -156 -33 -40 -30 -67 -74 -67 -107 l0 -20 -938 0 c-883 0 -940 -1 -973 -18 -19 -10 -131 -98 -247 -196 -303 -255 -303 -235 0 -491 116 -98 227 -187 247 -197 40 -21 169 -25 202 -7 11 6 41 42 66 81 l45 70 48 -76 c74 -115 109 -114 187 6 l46 70 47 -74 c26 -41 55 -78 65 -82 22 -8 378 -8 401 1 9 3 38 40 65 81 l47 75 46 -71 c25 -39 54 -76 65 -81 12 -7 122 -11 299 -11 l279 0 7 -31 c9 -46 44 -89 90 -110 31 -14 65 -19 143 -19 l102 0 33 -37 c175 -195 268 -271 419 -346 439 -216 960 -124 1298 228 338 352 410 852 188 1290 -140 277 -408 491 -714 572 -135 35 -366 42 -493 14z m414 -136 c365 -70 665 -363 758 -742 31 -126 31 -324 0 -447 -96 -381 -386 -662 -765 -740 -95 -20 -281 -21 -379 -2 -231 45 -443 176 -598 371 -70 89 -113 108 -255 115 l-110 5 -3 57 c-2 48 -7 61 -29 78 -25 19 -39 20 -323 20 l-297 0 -67 104 c-98 153 -119 153 -221 -4 l-64 -100 -138 0 -138 1 -64 100 c-35 55 -73 105 -85 110 -38 18 -70 -4 -117 -80 -24 -39 -46 -71 -49 -71 -3 1 -25 33 -49 71 -76 123 -108 118 -202 -30 l-64 -101 -43 0 c-40 0 -51 8 -233 162 l-191 162 24 18 c22 17 78 18 1071 18 1034 0 1047 0 1067 20 25 25 26 61 1 91 l-19 24 -963 5 -962 5 79 65 78 65 977 5 c1118 6 1016 -4 1021 99 l3 56 110 6 c158 9 179 20 284 151 151 187 388 316 640 348 80 10 219 4 315 -15z"></path><path d="M4222 3275 c-80 -35 -134 -101 -154 -187 -22 -99 37 -222 131 -270 63 -33 157 -38 219 -13 49 21 110 80 133 130 21 46 25 129 7 187 -15 51 -82 126 -133 149 -49 23 -156 24 -203 4z m148 -128 c32 -16 70 -73 70 -106 0 -38 -35 -89 -74 -107 -72 -35 -154 14 -163 98 -4 37 -1 49 23 77 42 50 93 64 144 38z"></path><path d="M1077 1552 c-13 -14 -17 -38 -17 -90 0 -40 -4 -72 -10 -72 -5 0 -32 14 -60 30 -59 35 -92 38 -120 10 -41 -41 -23 -85 55 -129 30 -17 55 -33 55 -36 0 -3 -25 -19 -55 -36 -78 -44 -96 -88 -55 -129 28 -28 61 -25 120 10 28 17 55 30 60 30 6 0 10 -33 10 -74 0 -66 3 -77 22 -90 31 -22 64 -20 88 4 16 16 20 33 20 90 0 39 3 70 7 70 3 0 30 -13 60 -30 63 -36 92 -38 121 -7 43 46 25 82 -67 132 l-51 28 59 35 c65 38 87 68 76 101 -18 58 -61 65 -138 21 -30 -16 -57 -30 -60 -30 -4 0 -7 32 -7 70 0 57 -4 74 -20 90 -25 25 -72 26 -93 2z"></path><path d="M1791 1544 c-16 -21 -21 -41 -21 -91 0 -36 -4 -63 -8 -61 -5 2 -34 16 -65 33 -46 24 -60 28 -84 20 -34 -13 -51 -54 -36 -88 7 -14 37 -40 69 -58 50 -28 55 -34 40 -43 -97 -59 -111 -72 -114 -103 -4 -37 26 -73 60 -73 12 0 45 14 75 30 29 17 55 30 57 30 2 0 6 -32 8 -71 3 -60 8 -74 27 -90 31 -25 66 -24 91 3 16 17 20 35 20 90 0 37 3 68 8 68 4 0 30 -14 57 -30 63 -37 97 -38 124 -4 12 15 21 33 21 41 0 20 -56 73 -104 98 l-38 21 51 27 c50 28 91 69 91 92 0 7 -9 24 -21 39 -27 34 -61 33 -124 -4 -27 -16 -53 -30 -57 -30 -5 0 -8 32 -8 70 0 57 -4 74 -20 90 -29 29 -74 26 -99 -6z"></path><path d="M2511 1544 c-16 -21 -21 -41 -21 -90 0 -35 -2 -64 -5 -64 -3 0 -29 14 -58 30 -61 34 -83 37 -115 14 -15 -10 -22 -25 -22 -49 0 -36 27 -63 100 -100 32 -16 33 -19 16 -29 -94 -55 -111 -71 -114 -108 -2 -28 2 -40 20 -52 32 -23 54 -20 115 14 29 17 55 30 58 30 3 0 5 -29 5 -64 0 -76 24 -116 70 -116 46 0 70 40 70 116 0 35 2 64 5 64 3 0 29 -13 58 -30 61 -34 83 -37 115 -14 18 12 22 24 20 52 -3 37 -20 53 -114 108 -17 10 -16 13 16 29 73 37 100 64 100 100 0 24 -7 39 -22 49 -32 23 -54 20 -115 -14 -29 -16 -55 -30 -58 -30 -3 0 -5 29 -5 64 0 76 -24 116 -70 116 -19 0 -36 -9 -49 -26z"></path><path d="M3230 1550 c-16 -16 -20 -33 -20 -90 0 -38 -3 -70 -7 -70 -5 0 -30 14 -58 30 -63 37 -97 38 -124 4 -12 -15 -21 -33 -21 -41 0 -20 56 -73 103 -98 l38 -21 -60 -33 c-75 -43 -94 -78 -64 -119 28 -38 64 -39 127 -3 29 17 56 31 60 31 3 0 6 -31 6 -70 0 -80 19 -110 68 -110 46 0 66 31 70 111 2 38 6 69 8 69 2 0 28 -13 57 -30 30 -16 63 -30 75 -30 34 0 64 36 60 73 -3 31 -17 44 -114 103 -15 9 -10 15 40 43 32 18 62 44 69 58 15 34 -2 75 -36 88 -24 8 -38 4 -84 -20 -31 -17 -60 -31 -64 -33 -3 -2 -8 28 -11 67 -2 50 -9 75 -22 90 -24 27 -70 27 -96 1z"></path><path d="M3950 1550 c-16 -16 -20 -33 -20 -90 0 -38 -3 -70 -7 -70 -3 0 -30 14 -60 30 -77 44 -120 37 -138 -21 -11 -34 12 -64 76 -100 63 -35 63 -34 -4 -70 -77 -41 -97 -84 -57 -127 28 -30 60 -28 123 8 30 16 57 30 60 30 4 0 7 -31 7 -70 0 -57 4 -74 20 -90 24 -24 57 -26 88 -4 19 13 22 24 22 90 0 41 4 74 10 74 5 0 32 -13 60 -30 59 -35 92 -38 120 -10 41 41 23 85 -55 129 -30 17 -55 33 -55 36 0 3 25 19 55 36 78 44 96 88 55 129 -28 28 -61 25 -120 -10 -28 -16 -55 -30 -60 -30 -6 0 -10 33 -10 73 0 59 -4 77 -18 90 -25 23 -68 21 -92 -3z"></path></g></svg>
        </div>
        <div id="logout-btn" title="Déconnexion">
            <svg class="nav-icon" viewBox="0 0 512 512" fill="currentColor"><g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"><path d="M1775 4899 c-372 -47 -668 -318 -741 -678 -20 -102 -15 -280 11 -381 37 -140 124 -291 225 -391 162 -159 364 -241 595 -243 290 -2 545 132 706 370 95 141 137 268 146 439 21 424 -289 810 -701 874 -96 15 -176 19 -241 10z m280 -154 c196 -53 365 -193 455 -380 51 -104 72 -197 71 -315 -1 -395 -321 -710 -721 -710 -77 0 -235 37 -301 70 -144 74 -257 186 -325 325 -57 117 -75 188 -76 310 -1 133 14 201 72 320 96 199 257 328 480 386 90 23 249 20 345 -6z"></path><path d="M3760 3484 c-287 -61 -505 -281 -565 -569 -21 -99 -19 -147 6 -179 l20 -26 193 0 c212 0 236 6 236 59 0 96 72 205 158 238 129 49 267 -6 323 -129 23 -52 24 -60 27 -380 l3 -328 -403 0 -403 1 -55 87 c-220 348 -588 620 -985 727 -166 44 -289 58 -494 53 -271 -7 -452 -49 -688 -163 -176 -84 -309 -179 -458 -329 -275 -276 -428 -571 -491 -946 -20 -118 -30 -485 -15 -578 19 -122 73 -208 168 -269 103 -66 45 -63 1339 -63 l1171 0 5 -104 c5 -84 11 -116 32 -163 35 -76 104 -144 180 -180 l61 -28 775 0 775 0 60 24 c81 33 163 115 196 196 l24 60 0 695 0 695 -23 56 c-43 108 -154 202 -254 215 l-46 6 -5 362 c-5 399 -9 430 -72 561 -72 150 -188 267 -340 340 -146 71 -305 92 -455 59z m294 -140 c182 -47 336 -190 404 -375 l27 -74 3 -362 3 -363 -100 0 -101 0 0 328 c0 271 -3 338 -16 383 -32 108 -110 199 -213 248 -49 23 -69 26 -156 26 -88 0 -107 -4 -162 -29 -40 -18 -80 -47 -113 -82 -49 -52 -100 -141 -100 -176 0 -16 -12 -18 -105 -18 l-105 0 6 28 c19 84 29 113 62 176 70 133 217 251 363 290 73 20 226 20 303 0z m-2033 -444 c447 -46 848 -275 1114 -639 67 -91 68 -99 5 -100 -49 -2 -144 -56 -196 -114 -91 -99 -88 -76 -92 -685 l-3 -532 -1193 2 -1193 3 -49 30 c-30 19 -60 49 -79 80 l-30 49 0 265 c0 286 8 354 61 528 111 371 365 697 698 898 283 170 629 248 957 215z m2653 -882 c53 -16 118 -81 134 -134 17 -59 17 -1329 0 -1388 -17 -56 -82 -119 -138 -135 -34 -9 -223 -11 -791 -9 l-745 3 -42 28 c-23 15 -54 46 -69 69 l-28 42 -3 683 c-2 655 -2 686 17 727 20 47 72 94 123 113 48 17 1484 18 1542 1z"></path><path d="M3761 1844 c-221 -47 -409 -214 -488 -431 -102 -281 7 -613 255 -776 451 -297 1042 14 1044 549 0 110 -16 182 -63 283 -68 147 -171 251 -315 322 -136 66 -288 85 -433 53z m301 -144 c246 -76 412 -342 370 -592 -34 -201 -189 -376 -381 -432 -72 -21 -221 -21 -292 0 -171 50 -307 182 -365 354 -28 82 -25 254 5 335 58 159 189 284 350 336 80 26 229 25 313 -1z"></path><path d="M3991 1268 c-169 -134 -206 -159 -215 -147 -6 8 -44 54 -85 102 -61 72 -78 87 -102 87 -16 0 -38 -9 -49 -20 -39 -39 -27 -66 86 -200 103 -122 142 -154 174 -142 18 7 460 358 478 380 18 23 15 66 -6 85 -42 38 -67 25 -281 -145z"></path></g></svg>
        </div>
    </nav>
</header>

<!-- Sélecteur global de station -->
<div class="station-selector">
    <div class="station-selector-container">
        <button id="collect-data-btn" class="station-icon-btn" title="Lancer une collecte de données">
            <svg class="nav-icon" viewBox="0 0 512 512" fill="currentColor"><g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"><path d="M2153 4907 l-213 -213 0 -585 c0 -583 0 -586 21 -605 20 -18 45 -19 599 -19 554 0 579 1 599 19 l21 19 0 779 c0 765 0 778 -20 798 -19 19 -33 20 -407 20 l-387 0 -213 -213z m887 -602 l0 -675 -480 0 -480 0 0 480 0 480 169 0 c230 0 215 -15 219 214 l3 176 285 0 284 0 0 -675z m-710 500 l0 -75 -77 0 -77 0 74 75 c41 41 76 75 77 75 2 0 3 -34 3 -75z"></path><path d="M2212 4390 c-13 -12 -22 -33 -22 -50 0 -17 9 -38 22 -50 21 -19 34 -20 348 -20 314 0 327 1 348 20 13 12 22 33 22 50 0 17 -9 38 -22 50 -21 19 -34 20 -348 20 -314 0 -327 -1 -348 -20z"></path><path d="M2210 4140 c-29 -29 -26 -74 7 -100 26 -20 34 -21 351 -18 l324 3 19 24 c25 30 24 66 -1 91 -19 19 -33 20 -350 20 -317 0 -331 -1 -350 -20z"></path><path d="M2240 3913 c-51 -19 -66 -77 -30 -113 19 -19 33 -20 350 -20 317 0 331 1 350 20 25 25 26 61 1 91 l-19 24 -319 2 c-175 1 -325 -1 -333 -4z"></path><path d="M744 4653 c-11 -2 -116 -100 -232 -217 l-212 -212 0 -581 0 -582 26 -20 c26 -21 35 -21 599 -21 549 0 574 1 596 19 l24 19 0 776 0 775 -23 23 -23 23 -367 1 c-202 1 -376 0 -388 -3z m666 -818 l0 -675 -485 0 -485 0 0 480 0 480 154 0 c159 0 209 9 226 40 6 10 10 93 10 184 l0 166 290 0 290 0 0 -675z m-720 505 l0 -70 -72 0 -72 0 69 70 c38 39 71 70 72 70 2 0 3 -31 3 -70z"></path><path d="M593 3936 c-37 -17 -49 -49 -34 -88 17 -45 56 -50 387 -46 280 3 303 4 323 22 28 25 28 77 0 102 -20 18 -42 19 -333 21 -251 2 -317 0 -343 -11z"></path><path d="M600 3693 c-52 -19 -66 -75 -27 -111 23 -22 28 -22 350 -22 314 0 328 1 347 20 29 29 26 74 -6 99 -26 20 -38 21 -338 20 -171 0 -318 -3 -326 -6z"></path><path d="M570 3430 c-25 -25 -26 -61 -1 -91 l19 -24 324 -3 c317 -3 325 -2 351 18 33 26 36 71 7 100 -19 19 -33 20 -350 20 -317 0 -331 -1 -350 -20z"></path><path d="M4015 4650 c-38 -12 -431 -405 -440 -440 -3 -14 -4 -279 -3 -588 l3 -564 24 -19 c22 -18 47 -19 600 -19 l578 0 21 23 22 23 0 771 c0 744 -1 772 -19 794 l-19 24 -369 2 c-202 1 -381 -2 -398 -7z m665 -815 l0 -675 -485 0 -485 0 0 479 0 479 174 4 c232 4 216 -12 216 215 l0 173 290 0 290 0 0 -675z m-720 505 l0 -70 -72 0 -72 0 69 70 c38 39 71 70 72 70 2 0 3 -31 3 -70z"></path><path d="M3885 3943 c-55 -14 -75 -82 -34 -119 20 -18 42 -19 319 -22 332 -3 371 1 389 46 18 42 -2 79 -48 92 -36 10 -587 12 -626 3z"></path><path d="M3858 3684 c-39 -21 -42 -76 -6 -106 18 -16 50 -18 345 -18 l324 0 24 25 c30 29 32 55 6 86 l-19 24 -324 2 c-273 2 -327 0 -350 -13z"></path><path d="M3847 3433 c-19 -23 -23 -41 -14 -74 12 -46 35 -49 371 -49 284 0 316 2 334 18 32 26 37 63 12 95 l-21 27 -333 0 c-304 0 -334 -1 -349 -17z"></path><path d="M2533 3359 c-40 -15 -43 -37 -43 -295 l0 -247 -22 21 c-36 32 -70 37 -101 12 -19 -15 -27 -30 -27 -53 1 -26 17 -49 93 -129 82 -87 97 -98 127 -98 30 0 45 11 127 98 76 80 92 103 93 129 0 23 -8 38 -27 53 -31 25 -65 20 -100 -12 l-23 -21 0 247 c0 142 -4 255 -10 266 -13 24 -59 39 -87 29z"></path><path d="M874 2886 c-18 -14 -19 -32 -22 -446 -2 -359 0 -436 11 -454 8 -11 73 -55 145 -96 72 -41 128 -78 124 -82 -4 -3 -16 -8 -26 -10 -10 -1 -28 -15 -39 -30 -17 -23 -19 -33 -11 -55 18 -51 47 -56 175 -28 195 43 194 41 149 210 -19 72 -40 129 -53 143 -26 28 -70 29 -98 1 -18 -18 -20 -28 -14 -66 l7 -46 -39 23 c-21 12 -73 42 -115 67 l-78 45 0 402 c0 378 -1 404 -18 419 -23 21 -71 22 -98 3z"></path><path d="M4147 2882 c-15 -17 -17 -60 -17 -419 l0 -401 -77 -45 c-43 -25 -96 -55 -117 -68 l-39 -23 7 38 c9 49 0 73 -32 89 -35 17 -69 11 -86 -16 -8 -12 -28 -76 -46 -142 -44 -169 -46 -167 149 -210 128 -28 157 -23 175 28 8 22 6 32 -11 55 -11 15 -29 29 -39 30 -10 2 -22 7 -26 11 -4 3 52 40 125 82 78 45 137 86 144 100 10 18 13 129 13 437 0 411 -2 443 -34 464 -21 14 -73 8 -89 -10z"></path><path d="M2390 2449 c-416 -23 -729 -126 -807 -264 l-23 -40 0 -913 c0 -745 2 -919 14 -945 17 -42 91 -109 157 -143 229 -116 730 -173 1125 -129 147 16 342 55 429 85 136 47 257 143 270 214 3 17 4 439 3 937 l-3 905 -28 43 c-112 169 -614 280 -1137 250z m508 -154 c226 -32 396 -81 471 -136 59 -42 62 -56 16 -96 -73 -63 -288 -126 -526 -154 -137 -16 -607 -7 -714 14 -202 39 -328 80 -394 128 -53 38 -59 54 -30 85 64 68 225 117 559 167 73 12 523 5 618 -8z m-1150 -404 c117 -59 377 -113 640 -132 137 -10 207 -10 345 0 262 19 522 73 639 132 21 11 40 19 43 19 3 0 5 -87 5 -194 l0 -194 -34 -29 c-128 -113 -599 -191 -998 -164 -190 13 -425 55 -537 97 -60 23 -126 63 -143 88 -9 12 -11 396 -3 396 3 0 22 -8 43 -19z m62 -595 c107 -44 294 -83 480 -101 418 -41 824 10 1118 142 9 4 12 -39 12 -199 l0 -204 -28 -27 c-62 -60 -238 -117 -472 -154 -163 -25 -558 -25 -719 0 -263 42 -435 100 -488 165 -10 12 -13 72 -13 220 0 160 3 203 13 199 6 -4 50 -22 97 -41z m39 -607 c90 -32 288 -69 441 -84 394 -39 823 10 1083 124 l47 20 0 -205 0 -205 -27 -25 c-67 -62 -221 -111 -474 -151 -161 -25 -557 -25 -719 0 -240 38 -418 94 -475 151 l-25 25 0 205 0 205 48 -20 c26 -12 71 -30 101 -40z"></path><path d="M2472 1609 c-41 -12 -58 -50 -41 -91 15 -37 68 -51 160 -42 58 6 73 11 90 32 24 31 19 68 -13 95 -23 19 -137 23 -196 6z"></path><path d="M2470 1017 c-41 -14 -57 -49 -41 -89 14 -38 72 -52 164 -41 59 7 73 12 90 34 24 33 13 78 -24 96 -30 16 -143 16 -189 0z"></path><path d="M2472 429 c-41 -12 -58 -50 -41 -91 16 -38 70 -52 162 -41 59 7 73 12 90 35 18 24 18 30 7 58 -7 17 -21 35 -31 40 -22 12 -143 11 -187 -1z"></path></g></svg>
            <div class="btn-spinner"></div>
        </button>
        <span class="station-info" id="station-info"></span>
    </div>
    <div class="status-message" id="status-bar"></div>
    <div class="station-selector-container">
        <select id="global-station-select">
            <option value="">Chargement des stations...</option>
        </select>
        <button id="add-station-btn" class="station-icon-btn" title="Ajouter une nouvelle station">
            <svg class="nav-icon" viewBox="0 0 512 512" fill="currentColor"><g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"><path d="M2270 4975 c-431 -55 -823 -212 -1172 -472 -126 -94 -326 -288 -431 -418 -290 -359 -476 -804 -528 -1265 -15 -133 -6 -479 16 -620 108 -696 497 -1297 1090 -1683 324 -211 687 -338 1080 -378 132 -13 452 -7 570 11 626 96 1175 411 1567 900 110 138 189 264 278 445 254 513 315 1083 179 1645 -78 317 -222 620 -428 895 -85 112 -308 342 -419 429 -362 286 -805 466 -1264 516 -130 14 -408 11 -538 -5z m652 -619 c371 -79 675 -243 930 -502 120 -121 184 -202 267 -335 288 -462 351 -1064 165 -1579 -187 -523 -613 -940 -1138 -1115 -222 -74 -414 -101 -666 -92 -262 10 -483 64 -715 176 -521 252 -880 714 -1002 1291 -25 115 -27 145 -28 360 0 210 3 247 24 350 67 325 213 620 430 867 247 282 601 489 980 573 150 33 223 39 436 35 166 -3 220 -8 317 -29z"></path><path d="M2443 3644 c-60 -22 -127 -86 -160 -152 l-28 -57 -3 -287 -3 -288 -278 0 c-317 0 -340 -4 -419 -75 -73 -66 -97 -122 -97 -225 0 -68 5 -93 23 -127 35 -66 78 -110 140 -140 l57 -28 287 -3 287 -4 3 -291 3 -292 31 -55 c36 -64 107 -123 171 -140 115 -33 253 12 324 104 60 78 62 93 66 404 l4 282 274 0 c321 0 352 6 435 90 147 146 109 384 -74 471 l-61 29 -282 0 -281 0 -4 283 c-3 279 -3 283 -29 337 -37 78 -71 114 -141 149 -52 26 -72 31 -132 30 -39 0 -90 -7 -113 -15z"></path></g></svg>
        </button>
    </div>
</div>
    <!-- Modale pour ajouter une station -->
    <div id="station-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ajouter une nouvelle station</h3>
            </div>
            <div class="modal-body">
                <div id="success-msg" class="success-message-add"></div>
                <form id="station-form">
                    <div class="form-group required">
                        <label for="station-name">Nom de la station</label>
                        <input type="text" id="station-name" required placeholder="Ex: Station Production">
                        <div class="error-message-add" id="name-error"></div>
                    </div>

                    <div class="form-group required">
                        <label for="station-host">Hôte</label>
                        <input type="text" id="station-host" required placeholder="Ex: 192.168.1.100 ou example.com">
                        <div class="error-message-add" id="host-error"></div>
                    </div>

                    <div class="form-group required">
                        <label for="station-port">Port</label>
                        <input type="number" id="station-port" required min="1" max="65535" placeholder="Ex: 8080">
                        <div class="error-message-add" id="port-error"></div>
                    </div>

                    <div class="form-group">
                        <label for="station-comment">Commentaire (optionnel)</label>
                        <input type="text" id="station-comment" placeholder="Description ou notes">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancel-btn">Annuler</button>
                <button type="submit" class="btn btn-primary" id="submit-btn" form="station-form">
                    <div class="spinner" id="spinner"></div>
                    <img src="svg/access-control.svg" class="access-control-icon">
                    Ajouter la station
                </button>
            </div>
        </div>
    </div>
    <!-- Modale pour ajouter une sonde calculée -->
    <div id="add-probe-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ajouter une nouvelle sonde calculée</h3>
            </div>
            <div class="modal-body">
                <form id="add-probe-form">
                    <div class="form-group required">
                        <label for="new-probe-key">Clé de la sonde (identifiant unique)</label>
                        <input type="text" id="new-probe-key" required placeholder="Ex: ma_sonde_calc">
                        <div class="error-message-add" id="probe-key-error"></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancel-probe-btn">Annuler</button>
                <button type="submit" class="btn btn-primary" id="submit-probe-btn" form="add-probe-form">
                    <img src="svg/access-control.svg" class="access-control-icon">
                    Ajouter
                </button>
            </div>
        </div>
    </div>
    <!-- Modale pour l'aide -->
    <div id="help-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Aide sur la fonction de calcul</h3>
            </div>
            <div class="modal-body" id="help-modal-body">
                <!-- Le contenu de l'aide sera injecté ici par JavaScript -->
            </div>
        </div>
    </div>
    <!-- Modale d'authentification -->
    <div id="auth-modal" class="modal">
        <div class="modal-content auth-modal-content">
            <div class="modal-header">
                <h3 id="auth-modal-title">Authentification requise</h3>
            </div>
            <div class="modal-body">
                <div id="auth-error-msg" class="error-message-add" style="display: none;"></div>
                <form id="login-form">
                    <div class="form-group">
                        <label for="auth-login">Login</label>
                        <input type="text" id="auth-login" value="admin" readonly>
                    </div>
                    <div class="form-group">
                        <label for="auth-password">Mot de passe</label>
                        <input type="password" id="auth-password" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary" id="login-submit-btn" form="login-form">Connexion</button>
            </div>
        </div>
    </div>
    <!-- Modale pour changer le mot de passe -->
    <div id="password-modal" class="modal">
        <div class="modal-content auth-modal-content">
            <div class="modal-header">
                <h3 id="password-modal-title">Changer le mot de passe</h3>
            </div>
            <div class="modal-body">
                <div id="password-error-msg" class="error-message-add" style="display: none;"></div>
                <form id="password-form">
                    <div class="form-group" id="old-password-group" style="display: none;">
                        <label for="old-password">Ancien mot de passe</label>
                        <input type="password" id="old-password">
                    </div>
                    <div class="form-group">
                        <label for="new-password">Nouveau mot de passe</label>
                        <input type="password" id="new-password" required>
                    </div>
                    <div class="form-group">
                        <label for="confirm-password">Confirmer le mot de passe</label>
                        <input type="password" id="confirm-password" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary" id="password-submit-btn" form="password-form">
                    Enregistrer
                </button>
            </div>
        </div>
    </div>
<main id="content-container" class="content-container">
    <section id="dashboard-section" class="content-section active">
        <!-- Contrôles de filtre réorganisés -->
        <div class="conditions-controls">
            <div class="filter-group">
                <input type="text" id="conditions-filter" placeholder="Rechercher une mesure..." value="">
                <svg id="view-all-btn" class="nav-icon" viewBox="0 0 24 24" fill="currentColor" title="Effacer le filtre et afficher toutes les tuiles">
                    <path d="M 5.08 3.23 c -0.06 0.02 -0.12 0.08 -0.15 0.14 -0.04 0.06 -0.05 1.32 -0.05 3.99 l 0.0 3.9 0.12 0.11 c 0.15 0.15 0.37 0.15 0.52 -0.0 l 0.12 -0.11 0.0 -3.66 0.0 -3.66 8.44 -0.0 8.44 -0.0 0.0 6.0 0.0 6.0 -2.71 -0.0 c -2.67 -0.0 -2.71 -0.0 -2.84 0.1 -0.17 0.14 -0.17 0.42 0.0 0.55 0.12 0.1 0.14 0.1 3.12 0.09 l 3.0 -0.01 0.09 -0.11 c 0.09 -0.11 0.09 -0.26 0.08 -6.64 -0.01 -6.2 -0.02 -6.53 -0.1 -6.61 -0.08 -0.08 -0.51 -0.08 -9.02 -0.09 -5.1 -0.0 -8.98 0.01 -9.04 0.03 z"></path>
                    <path d="M 6.95 5.11 c -0.06 0.02 -0.12 0.08 -0.15 0.14 -0.04 0.06 -0.05 0.95 -0.05 2.71 0.0 2.58 0.0 2.62 0.1 2.75 0.08 0.09 0.14 0.12 0.28 0.12 0.14 -0.0 0.2 -0.03 0.28 -0.12 0.09 -0.12 0.1 -0.19 0.1 -0.93 l 0.0 -0.8 0.91 -0.91 0.91 -0.91 1.04 1.55 c 1.11 1.66 1.12 1.68 1.41 1.56 0.12 -0.05 0.22 -0.2 0.64 -1.05 l 0.5 -0.99 0.77 0.46 c 0.8 0.48 0.97 0.55 1.12 0.47 0.05 -0.03 0.3 -0.4 0.56 -0.83 0.26 -0.43 0.48 -0.78 0.5 -0.78 0.01 -0.0 0.56 0.45 1.21 1.01 0.97 0.83 1.21 1.01 1.33 1.01 0.11 -0.0 0.23 -0.08 0.62 -0.47 l 0.48 -0.47 0.77 0.92 c 0.42 0.51 0.82 0.98 0.88 1.03 0.15 0.14 0.35 0.14 0.5 -0.01 0.23 -0.23 0.2 -0.29 -0.87 -1.58 -0.54 -0.65 -1.02 -1.21 -1.06 -1.25 -0.04 -0.03 -0.14 -0.06 -0.21 -0.06 -0.12 -0.0 -0.23 0.09 -0.64 0.49 l -0.5 0.49 -1.23 -1.05 c -1.31 -1.12 -1.39 -1.17 -1.59 -0.97 -0.05 0.05 -0.3 0.44 -0.55 0.86 -0.25 0.42 -0.46 0.77 -0.47 0.78 -0.0 0.0 -0.38 -0.21 -0.83 -0.48 -0.45 -0.27 -0.87 -0.49 -0.93 -0.49 -0.06 -0.0 -0.15 0.03 -0.2 0.07 -0.05 0.04 -0.28 0.45 -0.52 0.91 -0.23 0.47 -0.43 0.85 -0.45 0.85 -0.01 -0.0 -0.46 -0.65 -0.98 -1.43 -0.53 -0.79 -0.99 -1.45 -1.04 -1.48 -0.23 -0.12 -0.31 -0.07 -1.2 0.81 l -0.86 0.85 -0.01 -1.32 c -0.01 -1.44 -0.01 -1.44 -0.3 -1.49 -0.08 -0.01 -0.19 -0.0 -0.24 0.02 z"></path>
                    <path d="M 8.02 11.09 c -2.25 0.27 -4.51 1.61 -6.55 3.86 -0.57 0.63 -0.71 0.83 -0.71 0.99 0.0 0.25 1.04 1.41 2.04 2.29 1.48 1.3 2.87 2.05 4.45 2.42 0.5 0.12 0.64 0.13 1.38 0.13 0.9 -0.0 1.33 -0.07 2.17 -0.35 1.81 -0.6 3.79 -2.06 5.36 -3.95 0.45 -0.54 0.45 -0.56 -0.02 -1.12 -0.48 -0.59 -1.53 -1.62 -2.09 -2.07 -1.37 -1.09 -2.76 -1.8 -4.13 -2.1 -0.42 -0.09 -1.53 -0.15 -1.91 -0.11 z m 1.9 0.88 c 1.4 0.34 2.61 1.02 4.05 2.25 0.44 0.38 1.44 1.4 1.58 1.6 0.09 0.15 0.07 0.18 -0.67 0.95 -2.62 2.71 -5.16 3.69 -7.86 3.02 -1.31 -0.32 -2.78 -1.21 -4.11 -2.49 -0.68 -0.66 -1.27 -1.3 -1.27 -1.41 0.0 -0.11 1.55 -1.65 2.09 -2.07 1.44 -1.13 2.82 -1.79 4.17 -1.98 0.5 -0.07 1.49 -0.01 2.02 0.11 z"></path>
                    <path d="M 8.13 12.6 c -1.37 0.22 -2.37 1.1 -2.75 2.42 -0.15 0.54 -0.15 1.4 0.02 1.9 0.18 0.56 0.43 0.96 0.85 1.38 1.16 1.16 2.87 1.33 4.25 0.42 1.05 -0.7 1.65 -2.01 1.46 -3.21 -0.2 -1.21 -0.79 -2.08 -1.8 -2.58 -0.55 -0.28 -1.44 -0.42 -2.03 -0.33 z m 1.05 0.77 c 1.38 0.3 2.3 1.71 2.01 3.08 -0.23 1.07 -1.0 1.83 -2.07 2.04 -1.15 0.23 -2.34 -0.35 -2.82 -1.36 -0.51 -1.08 -0.33 -2.22 0.48 -3.05 0.62 -0.63 1.53 -0.9 2.4 -0.71 z"></path>
                    <path d="M 16.11 14.16 c -0.17 0.14 -0.17 0.42 0.0 0.55 0.12 0.1 0.16 0.1 2.77 0.1 l 2.64 -0.0 0.11 -0.12 c 0.08 -0.07 0.12 -0.17 0.12 -0.26 0.0 -0.09 -0.04 -0.19 -0.12 -0.26 l -0.11 -0.12 -2.64 -0.0 c -2.61 -0.0 -2.65 -0.0 -2.77 0.1 z"></path>
                </svg>
            </div>
            <div class="conditions-stats" id="conditions-stats-display"></div>
            <div class="view-group">
                <select id="conditions-group">
                    <option value="groupUsage" selected>Regroupement Fonctionnel</option>
                    <option value="measurement">Regroupement par Type de mesure</option>
                    <option value="groupCustom">Regroupement Personnel</option>
                    <option value="sensorDb">Regroupement par Type d'historique</option>
                    <option value="none">Custom Order (Drag & Drop)</option>
                </select>
            </div>
        </div>
        <div class="conditions-container" id="conditions-container">
            <!-- Les données météo seront chargées ici -->
        </div>
    </section>
    
    <section id="stations-section" class="content-section">
        <div id="settings-container">
            <!-- Le formulaire de configuration sera chargé ici -->
        </div>
    </section>
    
    <section id="compositeProbes-section" class="content-section">
        <div id="composite-probes-container">
            <!-- Le formulaire pour compositeProbes.json sera chargé ici -->
        </div>
    </section>

    <!-- Section modifiée dans le HTML principal -->
    <section id="settings-section" class="content-section">
        <div id="preferences-container">
            <!-- Le formulaire de préférences d'unités sera chargé ici -->
        </div>
    </section>
</main>

<!-- Custom Context Menu -->
<div id="custom-context-menu" class="context-menu"> // clic droit
    <ul>
        <li id="compare-selected">Comparer la sélection</li>
    </ul>
</div>

</main>
<footer class="footer">
    <!-- Contenu du panneau de détail intégré ici -->
    <!-- <div class="details-footer-header">
        <button id="close-details-footer" class="details-close-btn" title="Réduire">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"></path>
            </svg>
        </button>
    </div> -->
    <div id="d3-chart-container" class="chart-container"></div>
    <div class="footer-bottom" id="footer-bottom-info">
        <p>&copy; 2025 Probe Météo <b id="version"></b> - Développé par Alban LOPEZ</p>
    </div>
</footer>

<script>
    let selectedStation = null;
    let statusTimeout; // For the global status bar

    /**
     * Displays a message in the global status bar.
     * @param {string} message The message to display.
     * @param {string} type The type of message (e.g., 'success', 'error', 'loading', 'warning').
     */
    function showGlobalStatus(message, type) {
        const statusEl = document.getElementById('status-bar');
        if (!statusEl) return;

        clearTimeout(statusTimeout);

        if (message) {
            statusEl.textContent = message;
            statusEl.className = `status-message status-${type} show`;

            // Automatically hide after 5 seconds for non-loading messages
            if (type !== 'loading') {
                statusTimeout = setTimeout(() => {
                    statusEl.classList.remove('show');
                }, 5000);
            }
        } else {
            statusEl.classList.remove('show');
        }
    }

    // --- Authentication: Override fetch to handle 401 Unauthorized ---
    const originalFetch = window.fetch;
    window.fetch = async (...args) => {
        const response = await originalFetch(...args);

        if (response.status === 401) {
            // Ne pas afficher la modale pour les vérifications de statut ou les tentatives de connexion
            if (!args[0].includes('/api/auth/status') && !args[0].includes('/api/login')) {
                console.warn('Action non autorisée. Affichage de la modale de connexion.');
                if (typeof showLoginModal === 'function') showLoginModal();
            }
        }
        return response;
    };

    document.addEventListener('DOMContentLoaded', () => {
        // Variables globales
        let globalStations = [];
        let stationsConfig = {};

        // Éléments DOM
        const navItems = document.querySelectorAll('.navbar nav ul li');
        const sections = document.querySelectorAll('.content-section');
        const contentContainer = document.getElementById('content-container');
        const globalStationSelect = document.getElementById('global-station-select');
        const stationInfo = document.getElementById('station-info');
        const footerNavLinks = document.querySelectorAll('.footer-nav-link');
        let currentIndex = 0;

        // Mapping des sections pour l'URL
        const sectionMap = {
            'dashboard-section': 'dashboard',
            'stations-section': 'stations',
            'compositeProbes-section': 'composite-probes',
            'settings-section': 'settings'
        };

        const reverseSectionMap = {
            'dashboard': 'dashboard-section',
            'stations': 'stations-section', 
            'composite-probes': 'compositeProbes-section',
            'settings': 'settings-section'
        };

        // --- Gestion du plein écran ---
        const logoDiv = document.querySelector('.navbar .logo');
        if (logoDiv) {
            logoDiv.title = 'Passer en mode plein écran (F11)';
            logoDiv.addEventListener('click', () => {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(err => {
                        console.error(`Erreur lors du passage en plein écran: ${err.message}`, err);
                    });
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    }
                }
            });
        }

        // --- Gestion de l'URL et de l'historique ---
        
        function updateURL(sectionId, params = {}, replace = false) {
            const sectionName = sectionMap[sectionId];
            if (sectionName) {
                let hash = sectionName;
                const queryParams = [];
                for (const key in params) {
                    const value = params[key];
                    if (value) { // N'ajoute que les paramètres non vides
                        queryParams.push(`${encodeURIComponent(key)}=${encodeURIComponent(value)}`);
                    }
                }
                if (queryParams.length > 0) {
                    hash += `?${queryParams.join('&')}`;
                }
                const newUrl = `${window.location.pathname}#${hash}`;
                const state = { section: sectionName, params };

                // Utilise replaceState pour les changements fréquents (filtre) pour ne pas polluer l'historique
                if (replace) {
                    history.replaceState(state, '', newUrl);
                } else {
                    history.pushState(state, '', newUrl);
                }
            }
        }

        function updateDashboardURL(replace = false) {
            if (sections[currentIndex].id === 'dashboard-section') {
                const params = {
                    station: globalStationSelect.value,
                    filter: document.getElementById('conditions-filter').value,
                    group: document.getElementById('conditions-group').value
                };
                updateURL('dashboard-section', params, replace);
            }
        }

        function loadFromURL() {
            const hash = window.location.hash.slice(1) || 'dashboard';
            const [sectionName, query] = hash.split('?');
            const params = new URLSearchParams(query);

            if (sectionName && reverseSectionMap[sectionName]) {
                const sectionId = reverseSectionMap[sectionName];
                const sectionIndex = Array.from(sections).findIndex(section => section.id === sectionId);
                if (sectionIndex !== -1) {
                    currentIndex = sectionIndex;
                }
            }

            // Appliquer les paramètres du dashboard depuis l'URL
            const urlStation = params.get('station');
            const urlFilter = params.get('filter');
            const urlGroup = params.get('group');

            if (urlFilter) {
                document.getElementById('conditions-filter').value = urlFilter;
            }
            if (urlGroup) {
                document.getElementById('conditions-group').value = urlGroup;
            }

            let stationToSelect = null;
            if (urlStation && globalStations.some(s => s.id === urlStation)) {
                stationToSelect = urlStation;
            } else if (globalStations.length > 0) {
                stationToSelect = globalStations[0].id;
            }

            if (stationToSelect) {
                globalStationSelect.value = stationToSelect;
                // Mettre à jour manuellement l'état de la station sélectionnée
                selectedStation = globalStations.find(s => s.id === stationToSelect) || null;
                console.log('loadFromURL', selectedStation);
                if (selectedStation) {
                    stationInfo.textContent = `${selectedStation.location} (${selectedStation.host}:${selectedStation.port})`;
                    updateCollectButtonTitle(selectedStation.id);
                    updateAllSectionInfo();
                }
            }

            updateView(false); // Mettre à jour la vue sans modifier l'URL
            
            fetchStationSettings();
            fetchcompositeProbes();
        }

        // Écouter les changements d'URL (bouton retour du navigateur)
        window.addEventListener('popstate', (event) => {
            if (event.state && event.state.section) {
                const sectionId = reverseSectionMap[event.state.section];
                if (sectionId) {
                    const sectionIndex = Array.from(sections).findIndex(section => section.id === sectionId);
                    if (sectionIndex !== -1) {
                        currentIndex = sectionIndex;
                        loadFromURL(); // Recharger l'état complet depuis l'URL
                    }
                }
            } else {
                loadFromURL();
            }
        });

        // --- Gestion du sélecteur global de stations ---
        
        async function loadGlobalStations() {
            try {
                showStationStatus('Chargement des stations...', 'loading');
                const response = await fetch('/api/stations');
                if (!response.ok) throw new Error('Erreur de chargement des stations');
                
                const data = await response.json();
                if (data.success && data.stations) {
                    globalStations = data.stations;
                    document.getElementById('version').textContent = data.version;
                    populateStationSelector();
                    showStationStatus('', '');
                } else {
                    throw new Error('Format de réponse invalide');
                }
            } catch (error) {
                console.error('Erreur de chargement des stations:', error);
                showStationStatus('Erreur de chargement des stations', 'error');
                globalStationSelect.innerHTML = '<option value="">Erreur de chargement</option>';
            }
        }

        function populateStationSelector() {
            globalStationSelect.innerHTML = '<option value="">Sélectionner une station...</option>';
            
            globalStations.forEach(station => {
                const option = document.createElement('option');
                option.value = station.id;
                option.textContent = station.name;
                option.dataset.location = station.location;
                option.dataset.host = station.host;
                option.dataset.port = station.port;
                globalStationSelect.appendChild(option);
            });

            // La station sera sélectionnée par loadFromURL
        }

        async function updateCollectButtonTitle(stationId) {
            const collectBtn = document.getElementById('collect-data-btn');
            let title = 'Lancer une collecte de données'; // Default title

            if (!stationId) {
                collectBtn.title = title;
                return;
            }

            try {
                // Utilise le cache si disponible, sinon fetch
                const config = stationsConfig[stationId] || (await (await fetch(`/api/station/${stationId}`)).json()).settings;
                
                if (config) {
                    stationsConfig[stationId] = config; // Met à jour le cache
                    const cronInfo = config.cron;
                    if (cronInfo && cronInfo.enabled && cronInfo.value) {
                        title += ` (automatique toutes les ${cronInfo.value} minutes)`;
                    }
                }
            } catch (e) {
                console.warn('Impossible de récupérer la configuration de la station pour les informations cron', e);
            } finally {
                collectBtn.title = title;
            }
        }

        function onStationChange() {
            const selectedId = globalStationSelect.value;
            selectedStation = globalStations.find(s => s.id === selectedId) || null;
            
            if (selectedStation) {
                stationInfo.textContent = `${selectedStation.location} (${selectedStation.host}:${selectedStation.port})`;
                updateCollectButtonTitle(selectedStation.id);
                updateAllSectionInfo();
                refreshActiveSection();
                updateDashboardURL(); // Mettre à jour l'URL avec la nouvelle station
            } else {
                stationInfo.textContent = '';
                clearAllSectionInfo();
                updateCollectButtonTitle(null);
            }
        }

        function updateAllSectionInfo() {
            // Fonction pour mettre à jour les informations de toutes les sections
            document.getElementById('collect-data-btn').style.display = 'block';
        }

        function clearAllSectionInfo() {
            // Fonction pour effacer les informations de toutes les sections
            document.getElementById('collect-data-btn').style.display = 'none';
        }

        function showStationStatus(message, type) {
            if (message) {
                console.log(`Station status [${type}]: ${message}`);
            }
        }

        function refreshActiveSection() {
            const activeSectionId = sections[currentIndex].id;
            
            if (activeSectionId === 'dashboard-section') {
                fetchCurrentConditions();
            } else if (activeSectionId === 'stations-section') {
                fetchStationSettings();
            } else if (activeSectionId === 'settings-section') {
                fetchSettings();
            } else if (activeSectionId === 'compositeProbes-section') {
                // fetchcompositeProbes();
                // on va plutot le precharger
            }
        }

        // --- Navigation Logic ---
        
        function updateView(updateUrl = true, doRefresh = true) {
            if (contentContainer) {
                contentContainer.style.transform = `translateX(-${currentIndex * 100}vw)`;
            }

            navItems.forEach((item, index) => {
                if (index === currentIndex) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });

            // Mettre à jour les liens du footer
            footerNavLinks.forEach(link => {
                const linkSection = link.dataset.section;
                const currentSection = sections[currentIndex].id;
                if (linkSection === currentSection) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });

            // Mettre à jour l'URL si demandé
            if (updateUrl) {
                updateURL(sections[currentIndex].id);
            }

            // Gérer la visibilité du sélecteur de station et ajuster la mise en page
            const stationSelectorDiv = document.querySelector('.station-selector');
            const activeSectionId = sections[currentIndex].id;

            if (activeSectionId === 'compositeProbes-section' || activeSectionId === 'settings-section') {
                stationSelectorDiv.style.display = 'none';
                contentContainer.style.paddingTop = '60px'; // Hauteur de la navbar uniquement
                contentContainer.style.height = 'calc(100vh - 100px)'; // 60px navbar + 40px footer
            } else {
                stationSelectorDiv.style.display = 'flex';
                contentContainer.style.paddingTop = '110px'; // Hauteur navbar + sélecteur
                contentContainer.style.height = 'calc(100vh - 150px)'; // 110px header + 40px footer
            }

            if (doRefresh) {
                refreshActiveSection();
            }
        }

        function navigateToSection(sectionId) {
            const sectionIndex = Array.from(sections).findIndex(section => section.id === sectionId);
            if (sectionIndex !== -1) {
                currentIndex = sectionIndex;
                if (contentContainer) {
                    contentContainer.style.transition = 'transform 0.3s ease-out'; // La transition est gérée par updateView
                    updateView();
                    setTimeout(() => { contentContainer.style.transition = ''; }, 300);
                }
            }
        }

        navItems.forEach((item, index) => {
            item.addEventListener('click', () => {
                currentIndex = index;
                if (contentContainer) {
                    contentContainer.style.transition = 'transform 0.3s ease-out'; // La transition est gérée par updateView
                    updateView();
                    setTimeout(() => { contentContainer.style.transition = ''; }, 300);
                }
                updateDashboardURL();
            });
        });

        // Event listeners pour les liens du footer - supprimé car footer simplifié

        // --- Gestion du swipe ---
        let startX = 0;
        let startY = 0;
        let endX = 0; // endX est utilisé pour suivre le mouvement horizontal
        let isSwiping = false;
        let swipeDirection = null; // 'horizontal', 'vertical', ou null

        if (contentContainer) {
            contentContainer.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
                endX = startX; // Initialiser endX
                isSwiping = true;
                swipeDirection = null;
            });

            contentContainer.addEventListener('touchmove', (e) => {
                if (!isSwiping) return;
                
                const currentX = e.touches[0].clientX;
                const currentY = e.touches[0].clientY;

                if (swipeDirection === null) {
                    // Déterminer la direction après un petit seuil pour éviter les faux positifs
                    if (Math.abs(currentX - startX) > 10 || Math.abs(currentY - startY) > 10) {
                        swipeDirection = Math.abs(currentX - startX) > Math.abs(currentY - startY) ? 'horizontal' : 'vertical';
                    }
                }

                if (swipeDirection === 'horizontal') {
                    e.preventDefault(); // Empêche le scroll vertical UNIQUEMENT si on swipe horizontalement
                    endX = currentX;
                    const diffX = startX - endX;
                    contentContainer.style.transform = `translateX(calc(-${currentIndex * 100}vw - ${diffX}px))`;
                }
            });

            contentContainer.addEventListener('touchend', () => {
                if (!isSwiping) return;

                // Pour un swipe vertical, on laisse le navigateur gérer le scroll et on ne fait rien d'autre.
                if (swipeDirection === 'vertical') {
                    isSwiping = false;
                    swipeDirection = null;
                    return;
                }

                // Pour les swipes horizontaux (petits ou grands) et les taps.
                isSwiping = false;
                swipeDirection = null;
                
                const diffX = startX - endX;
                const oldIndex = currentIndex;

                if (diffX > 50 && currentIndex < sections.length - 1) {
                    currentIndex++;
                } else if (diffX < -50 && currentIndex > 0) {
                    currentIndex--;
                }

                // On met à jour la vue. Le refresh ne se fera que si l'index a changé.
                updateView(true, oldIndex !== currentIndex);
            });
        }

        // --- Event Listeners ---
        
        if (globalStationSelect) {
            globalStationSelect.addEventListener('change', onStationChange);
        }

        const refreshConditionsBtn = document.getElementById('refresh-conditions');
        if (refreshConditionsBtn) {
            refreshConditionsBtn.addEventListener('click', fetchCurrentConditions);
        }

        const conditionsFilter = document.getElementById('conditions-filter');
        const conditionsGroup = document.getElementById('conditions-group');

        if (conditionsFilter) {
            let filterTimeout;
            conditionsFilter.addEventListener('input', () => {
                applyCurrentFilter();
                clearTimeout(filterTimeout);
                // Utilise un debounce pour ne pas surcharger l'historique du navigateur
                filterTimeout = setTimeout(() => updateDashboardURL(true), 300);
            });
        }

        if (conditionsGroup) {
            conditionsGroup.addEventListener('change', () => {
                displayConditions();
                applyCurrentFilter();
                updateDashboardURL();
            });
        }

        const collectBtn = document.getElementById('collect-data-btn');
        if (collectBtn) {
            collectBtn.addEventListener('click', async () => {
                if (!selectedStation) {
                    showGlobalStatus('Aucune station sélectionnée', 'warning');
                    return;
                }

                showGlobalStatus(`Lancement de la collecte pour ${selectedStation.name}...`, 'loading');
                collectBtn.disabled = true;
                collectBtn.classList.add('loading');

                try {
                    const response = await fetch(`/api/station/${selectedStation.id}/collect`);
                    const result = await response.json();

                    if (response.ok && result.success) {
                        showGlobalStatus(result.message || `Collecte pour ${selectedStation.name} terminée avec succès.`, 'success');
                        setTimeout(() => refreshActiveSection(), 2000);
                    } else {
                        throw new Error(result.error || 'Erreur lors de la collecte.');
                    }
                } catch (error) {
                    showGlobalStatus(`Erreur de collecte: ${error.message}`, 'error');
                } finally {
                    collectBtn.disabled = false;
                    collectBtn.classList.remove('loading');
                }
            });
        }

        // --- Initialisation ---
        loadGlobalStations().then(() => {
            loadFromURL(); // Charger l'état complet depuis l'URL
        });

        // Vérifier le statut d'authentification au chargement
        if (typeof checkAuthStatus === 'function') checkAuthStatus();
    });

</script>
<!-- For Textarea Editor -->
<script src="js/highlight.js"></script>
<script src="js/textareaEditor.js"></script>
<script src="js/newStation.js"></script>
<script src="js/dashboard.js"></script>
<script src="js/station.js"></script>
<script src="js/auth.js"></script>
<script src="js/settings.js"></script>
<script src="js/compositeProbes.js"></script>
</body>
</html>